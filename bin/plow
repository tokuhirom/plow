#!/usr/bin/env perl
use strict;
use warnings;
use utf8;
use 5.10.0;
use Getopt::Long;

GetOptions(
    'e=s' => \my $eval,
);

use FindBin;
use File::Spec;
use Plow::Signatures;
use Plow;

my $libpath = File::Spec->catdir($FindBin::RealBin, '../lib');

if (defined $eval) {
    eval qq{
        use Plow::Signatures; use utf8::all;
        "#line 1 -e",
        $eval;
    };
} elsif (@ARGV > 0) {
    my $fname = shift @ARGV;
    open my $fh, '<', $fname;
    my $src = join("\n",
        "use 5.10.0; use utf8::all; use Plow::Signatures;",
        "#line 1 $fname",
        do { local $/; <$fh> }
    );
    eval $src;
    die $@ if $@;
} elsif (-t STDIN) {
    # repl
    ...
} else {
    # do it?
    ...
}

